<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø³ÙŠØªÙŠ Ù‡Ø§ÙŠØ¨Ø± - Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø­ÙŠØ©</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        /* (Ù†ÙØ³ ØªÙ†Ø³ÙŠÙ‚Ø§Øª CSS Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„ØªÙŠ Ø£Ø±Ø³Ù„ØªÙ‡Ø§ Ù…Ø¹ Ø¥Ø¶Ø§ÙØ© Ø¨Ø³ÙŠØ·Ø© Ù„Ù„Ø¨Ø·Ø§Ù‚Ø§Øª) */
        :root {
            --city-red: #e63946;
            --hyper-black: #1a1a1a;
            --bg-light: #f4f4f4;
            --white: #ffffff;
        }

        body { font-family: 'Cairo', sans-serif; margin: 0; background: var(--bg-light); display: flex; flex-direction: column; min-height: 100vh; }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .main-header { display: flex; justify-content: space-between; align-items: center; padding: 10px 5%; background: var(--white); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .brand-name { font-size: 1.5rem; font-weight: 900; }
        .city { color: var(--city-red); }

        /* Ø§Ù„Ø¨Ù†Ø± */
        .banner-container { width: 100%; height: 250px; overflow: hidden; position: relative; margin-bottom: 20px; background: #ddd; }
        .banner-slide { width: 100%; height: 100%; display: none; object-fit: cover; }

        /* Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª ÙˆØ§Ù„Ø¨Ø­Ø« */
        .search-section { padding: 0 5%; margin-bottom: 20px; }
        .search-input { width: 100%; padding: 12px 20px; border: 2px solid #ddd; border-radius: 25px; outline: none; }
        .categories-tags { display: flex; gap: 10px; overflow-x: auto; padding: 0 5% 10px; scrollbar-width: none; }
        .tag-btn { padding: 8px 18px; background: var(--white); border: 1px solid var(--city-red); color: var(--city-red); border-radius: 20px; cursor: pointer; white-space: nowrap; }
        .tag-btn.active { background: var(--city-red); color: var(--white); }

        /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
        .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 15px; padding: 0 5% 40px; }
        .product-card { background: white; border-radius: 12px; padding: 10px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .product-card img { width: 100%; height: 150px; object-fit: contain; border-radius: 8px; }
        .old-price { text-decoration: line-through; color: #888; font-size: 0.9rem; }
        .new-price { color: var(--city-red); font-weight: 900; font-size: 1.2rem; display: block; }
        
        .main-footer { background-color: var(--city-red); color: var(--white); padding: 30px 5%; text-align: center; margin-top: auto; }
    </style>
</head>
<body>

    <header class="main-header">
        <div class="brand-name"><span class="city">Ø³ÙŠØªÙŠ</span> <span>Ù‡Ø§ÙŠØ¨Ø±</span></div>
    </header>

    <div class="banner-container" id="banner-wrapper">
        </div>

    <div class="search-section">
        <input type="text" class="search-input" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¹Ø±Ø¶..." oninput="searchProducts()">
    </div>

    <div class="categories-tags" id="catTags">
        <button class="tag-btn active" onclick="filterByCat('all', this)">Ø§Ù„ÙƒÙ„</button>
        </div>

    <main class="products-grid" id="productsDisplay">
        </main>

    <footer class="main-footer">
        <p>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© &copy; 2026 Ø³ÙŠØªÙŠ Ù‡Ø§ÙŠØ¨Ø±</p>
    </footer>

    <script>
        // 1. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù…Ø´Ø±ÙˆØ¹Ùƒ ğŸ”—
        const supabaseUrl = 'https://lluxexpussqaigzqmdii.supabase.co';
        const supabaseKey = 'sb_publishable_Gp8P3aKK3I2zf3PppaiR4w_nknZVUyA';
        const _supabase = supabase.createClient(supabaseUrl, supabaseKey);

        let allProducts = []; // Ù…Ø®Ø²Ù† Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ÙÙ„ØªØ±Ø©

        // 2. Ø¬Ù„Ø¨ Ø§Ù„Ø¨Ù†Ø±Ø§Øª ğŸ–¼ï¸
        async function loadBanners() {
            const { data } = await _supabase.from('banners').select('*');
            const wrapper = document.getElementById('banner-wrapper');
            if (data && data.length > 0) {
                wrapper.innerHTML = data.map((b, i) => 
                    `<img src="${b.image_url}" class="banner-slide" style="display:${i===0?'block':'none'}">`
                ).join('');
                startBannerCycle();
            }
        }

        // 3. Ø¬Ù„Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª ğŸ“‚
        async function loadCategories() {
            const { data } = await _supabase.from('categories').select('*');
            const container = document.getElementById('catTags');
            if (data) {
                data.forEach(cat => {
                    container.innerHTML += `<button class="tag-btn" onclick="filterByCat('${cat.id}', this)">${cat.name}</button>`;
                });
            }
        }

        // 4. Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ğŸ
        async function loadProducts() {
            const { data } = await _supabase.from('products').select('*');
            if (data) {
                allProducts = data;
                displayProducts(allProducts);
            }
        }

        function displayProducts(list) {
            const grid = document.getElementById('productsDisplay');
            grid.innerHTML = list.map(p => `
                <div class="product-card">
                    <img src="${p.image_url}" alt="${p.name}">
                    <h4>${p.name}</h4>
                    ${p.old_price ? `<span class="old-price">${p.old_price} Ø±ÙŠØ§Ù„</span>` : ''}
                    <span class="new-price">${p.new_price} Ø±ÙŠØ§Ù„</span>
                </div>
            `).join('');
        }

        // 5. Ù…Ù†Ø·Ù‚ Ø§Ù„ÙÙ„ØªØ±Ø© ÙˆØ§Ù„Ø¨Ø­Ø« ğŸ”
        function filterByCat(catId, btn) {
            document.querySelectorAll('.tag-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            
            const filtered = catId === 'all' ? allProducts : allProducts.filter(p => p.category_id == catId);
            displayProducts(filtered);
        }

        function searchProducts() {
            const term = document.getElementById('searchInput').value.toLowerCase();
            const filtered = allProducts.filter(p => p.name.toLowerCase().includes(term));
            displayProducts(filtered);
        }

        // Ù…Ù†Ø·Ù‚ Ø­Ø±ÙƒØ© Ø§Ù„Ø¨Ù†Ø±
        function startBannerCycle() {
            let current = 0;
            const slides = document.querySelectorAll('.banner-slide');
            if(slides.length <= 1) return;
            setInterval(() => {
                slides[current].style.display = 'none';
                current = (current + 1) % slides.length;
                slides[current].style.display = 'block';
            }, 5000);
        }

        // ØªØ´ØºÙŠÙ„ ÙƒÙ„ Ø´ÙŠØ¡ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        loadBanners();
        loadCategories();
        loadProducts();
    </script>
</body>
</html>
